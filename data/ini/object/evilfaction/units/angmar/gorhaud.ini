;------------------------------------------------------------------------------
;
;     Gorhaud.ini
;
;------------------------------------------------------------------------------
; Aka The Dragolich of Angmar
Object AngmarGorhaud
	; *** ART Parameters ***

    Scale = 1.4

	; This is required for garrisoned objects - please put in all objects.
	ButtonImage = HIDrogoth
    
    ; SelectPortrait for Heros is portrait behind skill buttons. HP = HeroPortrait.
	SelectPortrait = HPDrogoth_Portrait
	
	DescriptionStrategic = CONTROLBAR:LW_ToolTip_Brisal
	
	ShockwaveResistance = SHOCKWAVE_RESISTANCE_ALWAYS

	Draw = W3DScriptedModelDraw ModuleTag_01
	    	  
	    OkToChangeModelColor = Yes
	    
	    StaticModelLODMode = Yes
	    	  
		DefaultModelConditionState
			Model				= KUDrgnLch_SKN
			WeaponLaunchBone	= PRIMARY BAT_JAW
			WeaponLaunchBone	= SECONDARY BAT_TAIL08
			
			;ParticleSysBone = None SoWolf_Ambient_fog01
			;ParticleSysBone = None SoWolf_Ambient_Embers01
			;ParticleSysBone = "Bip L Finger2" SoWolf_Ambient_fog FollowBone:YES	;"BIP L HAND"
			;ParticleSysBone = "Bip L Finger2" SoWolf_Ambient_Embers FollowBone:YES
			;ParticleSysBone = "Bip R Finger2" SoWolf_Ambient_fog FollowBone:YES	;"BIP R HAND"
			;ParticleSysBone = "Bip R Finger2" SoWolf_Ambient_Embers FollowBone:YES
			
			ParticleSysBone = None SoWolf_Ambient_fog01 ;none
			ParticleSysBone = None SoWolf_Ambient_Embers01 ;none
			ParticleSysBone = BAT_WING12 SoWolf_Ambient_fog FollowBone:YES	;"BIP L HAND"
			ParticleSysBone = BAT_WING12 SoWolf_Ambient_Embers FollowBone:YES
			ParticleSysBone = BAT_WING16 SoWolf_Ambient_fog FollowBone:YES	;"BIP R HAND"
			ParticleSysBone = BAT_WING16 SoWolf_Ambient_Embers FollowBone:YES
			ParticleSysBone = BAT_WING15 SoWolf_Ambient_fog FollowBone:YES	;"BIP R HAND"
			ParticleSysBone = BAT_WING15 SoWolf_Ambient_Embers FollowBone:YES
			ParticleSysBone = BAT_WING02 SoWolf_Ambient_fog FollowBone:YES	;"BIP R HAND"
			ParticleSysBone = BAT_WING02 SoWolf_Ambient_Embers FollowBone:YES
		End	
		
		IdleAnimationState
			StateName = Idle
			Animation = IDLA
				AnimationName = WUDrogoth_SKL.WUDrogoth_FLYA
				AnimationMode = LOOP
				;AnimationBlendTime = 10
				AnimationSpeedFactorRange = 0.95 1.05
			End
			BeginScript
 				Prev = CurDrawablePrevAnimationState()
 				if Prev == "STATE_WingBlastLoop" then
 					CurDrawableSetTransitionAnimState("TRANS_WingBlastStop") end
 			EndScript
		End

		AnimationState						= PARALYZED
			Animation
				AnimationName				= WUDrogoth_SKL.WUDrogoth_FLYA
				AnimationMode				= LOOP
			End
		End

  		AnimationState = DYING
   			StateName = DYING
			Animation = DyingA
				AnimationName = WUDrogoth_SKL.WUDrogoth_DIEK
  				AnimationMode = ONCE
  				;AnimationBlendTime = 10
                ;AnimationSpeedFactorRange = 0.5 0.5
  			End
		End

 		AnimationState	= BACKING_UP
   			StateName = backup
   			Animation = IDLA
   				AnimationName = WUDrogoth_SKL.WUDrogoth_FLYA
   				AnimationMode = LOOP
   				;AnimationBlendTime = 10
				AnimationSpeedFactorRange = 0.95 1.05
   			End
   		End
   
   		AnimationState = DIVING
   			StateName = Diving
   			Animation = Diving
   				AnimationName = WUDrogoth_SKL.WUDrogoth_FLYA
   				AnimationMode = LOOP
   				;AnimationBlendTime = 10
 				AnimationSpeedFactorRange = 0.95 1.05
  			End
   		End

		AnimationState = ABOUT_TO_HIT ; clawing
			StateName = Claw
			Animation = Claw
				AnimationName = WUDrogoth_SKL.WUDrogoth_ATKA
				AnimationMode = LOOP
				;AnimationBlendTime = 10
			End
		End

            ;;; GO ON FOOT ;;;
		AnimationState        = PACKING_TYPE_1
			Animation           = CHRA
				AnimationName     = SumnDrag_SKL.SumnDrag_LNDA
				AnimationMode     = ONCE
			End
		End

		;--- FIREBALL ----------------------------------------------------------------------------
		AnimationState			= SPECIAL_WEAPON_ONE				; fireball
			Animation
				AnimationName	= WUDrogoth_SKL.WUDrogoth_SPCA
				AnimationMode   = LOOP								; loop it, because this looks better than just stopping immediately after.
			End
		End
		
	

		;--- BLIZZARD ----------------------------------------------------------------------------
		AnimationState			= SPECIAL_WEAPON_TWO				; incinerate
			Animation
				AnimationName	= WUDrogoth_SKL.WUDrogoth_SPCB
				AnimationMode   = LOOP
			End

			;ParticleSysBone = BAT_HEAD DrogothFireBreath FollowBone:Yes
			;ParticleSysBone = BAT_JAW balrogBreathEmbers FollowBone:Yes
			;ParticleSysBone = BAT_JAW balrogBreathSmoke FollowBone:Yes
			;ParticleSysBone = BAT_HEAD DrogothBreathProxy FollowBone:Yes

			;ParticleSysBone = BAT_JAW DragolichFrostSmokeWaves FollowBone:Yes
			;ParticleSysBone = BAT_HEAD DragolichFrostHeat	FollowBone:Yes
			;ParticleSysBone = BAT_HEAD DragolichFrostSmoke			FollowBone:Yes

			ParticleSysBone = BAT_HEAD DragolichFrostBreath2	FollowBone:Yes			
			ParticleSysBone = BAT_HEAD DragolichFrostEmbers		FollowBone:Yes			
			ParticleSysBone = BAT_HEAD DragolichFrostFireProxy2			FollowBone:Yes
			ParticleSysBone = BAT_JAW SummonedDragonWaves	FollowBone:Yes
			
		End
		
		;--- MORGUL DEVASTATION ----------------------------------------------------------------------------
		AnimationState			= SPECIAL_WEAPON_THREE				
			Animation
				AnimationName				= WUDrogoth_SKL.WUDrogoth_SPCF
				AnimationMode				= LOOP
				AnimationSpeedFactorRange	= 0.9 0.9				; to match the weapon timing.
			End
		End

		;--- HARD FLAPPING ----------------------------------------------------------------------------
		AnimationState = CLIMBING
			StateName = Climbing
			Animation = Moving
				AnimationName = WUDrogoth_SKL.WUDrogoth_FLYA
				AnimationMode = LOOP
				;AnimationBlendTime = 10
				AnimationSpeedFactorRange = 0.95 1.05
			End
		End
		AnimationState = FREEFALL
			StateName = Freefall
			Animation = Moving
				AnimationName = WUDrogoth_SKL.WUDrogoth_FLYA
				AnimationMode = LOOP
				;AnimationBlendTime = 10
			End
		End

		AnimationState = MOVING
			StateName = Moving
			Animation = Moving
				AnimationName = WUDrogoth_SKL.WUDrogoth_FLYB
				AnimationMode = LOOP
				;AnimationBlendTime = 10
				AnimationSpeedFactorRange = 0.9 1.1
			End
 	 		BeginScript
 				Prev = CurDrawablePrevAnimationState()
 				if Prev == "Idle"	then CurDrawableSetTransitionAnimState("Trans_Begin_Moving") return end
 				if Prev == "Climbing"	then CurDrawableSetTransitionAnimState("Trans_Begin_Moving") return end
 				if Prev == "STATE_WingBlastLoop" then
 					CurDrawableSetTransitionAnimState("TRANS_WingBlastStop") end
 			EndScript
 		End

   	    TransitionState = Trans_Begin_Moving
   			Animation = Transition
   				AnimationName = WUDrogoth_SKL.sumndrag_wlka;WUDrogoth_FLYC
   				AnimationMode = ONCE
   				AnimationBlendTime = 6
   			End  
   		End
   		
   		AnimationState = LEVELED
			Animation
				AnimationName = WUDrogoth_SKL.WUDrogoth_LVLA
				AnimationMode = LOOP
			End
		End

		;AnimationState = RUBBLE 
		;	Animation = RubbleDieF
		;		AnimationName = WUDrogoth_SKL.WUDrogoth_FLYA
		;		AnimationMode = ONCE
		;		AnimationBlendTime = 4
		;	End
		;End
	    
	End 
	
	Draw = W3DLightDraw ModuleTag_DrawLight
		Ambient = R:25 G:25 B:45
		Diffuse = R:61 G:101 B:200 ;245
		Radius = 30 ;75
		Intensity = 1 ;30 ;75
		;AttachToBoneInAnotherModule = STAFF
	End

	; ***DESIGN parameters ***
	Side				= Angmar
	EditorSorting		= UNIT
	ThreatLevel			= SUMMONEDDRAGON_THREAT_LEVEL
	RadarPriority		= UNIT
	ThingClass			= LARGE_MONSTER
	TransportSlotCount	= TRANSPORTSLOTCOUNT_NOT_TRANSPORTABLE
	;//DisplayMeleeDamage	= GORHAUD_PLOW_DAMAGE_INNER
 	BuildCost			= GORHAUD_BUILDCOST				
 	BuildTime			= GORHAUD_BUILDTIME
 			
	WeaponSet
	
		; Primary is for special powers.
	
		Weapon				= SECONDARY		GorhaudPlowAttack
		PreferredAgainst	= SECONDARY		STRUCTURE MACHINE HORDE INFANTRY CAVALRY

		Weapon				= TERTIARY		GorhaudClawAttack
		OnlyAgainst			= TERTIARY		MONSTER

		ReadyStatusSharedWithinSet = Yes
	End

	ArmorSet
		Conditions      = None
		Armor           = DragolichArmor
		DamageFX        = FellBeastDamageFX
	End

	VisionRange			= VISION_FLIER
	ShroudClearingRange = SHROUD_CLEAR_FLIER
	
	DisplayName			= OBJECT:Gorhaud
	RecruitText			= CONTROLBAR:AngmarGorhaudRecruit
	ReviveText			= CONTROLBAR:AngmarGorhaudRevive
	Hotkey				= CONTROLBAR:AngmarGorhaudHotkey
	RamPower			= 45
	RamZMult			= 0.5
	CrusherLevel           	= 4  			; What can I crush?: 1 = infantry, 2 = trees, 3 = vehicles
	CrushWeapon 		= BalrogCrush								;What can I crush?: 1 = infantry, 2 = trees, 3 = vehicles
	CrushKnockback		= 50
	CrushZFactor		= 1.0
	CommandSet			= GorhaudCommandSet
	CommandPoints		= 75


	; *** AUTO RESOLVE DATA *** 
	AutoResolveUnitType = AutoResolveUnit_Hero
	AutoResolveCombatChain = AutoResolve_HeroCombatChain

	AutoResolveBody = AutoResolve_DrogothBody

	AutoResolveArmor
		Armor = AutoResolve_DrogothArmor
	End

	AutoResolveWeapon
		Weapon = AutoResolve_DrogothWeapon
	End

	;AutoResolveLeadership = AutoResolve_DrogothBonus

	 
	; *** AUDIO Parameters ***;

	VoiceAttack							= DrogothVoxAttack
	VoiceAttackCharge					= DrogothVoxAttackCharge
	VoiceCreated						= EVA:DrogothCreated
	VoiceFullyCreated					= EVA:DrogothCreated
	VoiceFear							= EVA:DrogothHelpMe
	VoiceGuard							= DrogothVoxMoveMS
	VoiceMove							= DrogothVoxMoveMS
	VoicePriority						= 90
	VoiceSelect							= DrogothVoxSelect

	VoiceEnterStateAttack				= DrogothVoxEnterStateAttack
	VoiceEnterStateAttackCharge			= DrogothVoxEnterStateAttackCharge
	VoiceEnterStateAttackStructure		= DrogothVoxEnterStateAttackBuilding

	SoundAmbient						= DrogothVoxAmbientLoop
	SoundImpact							= ImpactHorse
	SoundMoveStart						= FellBeastMoveStart
  
	;UnitSpecificSounds
	;End

    #include "..\..\..\includes\StandardUnitEvaEvents.inc"
	;EvaEventDieOwner		= DrogothDie			;Eva event to trigger on unit's death. NOTICE THAT this is only for permanent deaths

	ClientBehavior = ModelConditionAudioLoopClientBehavior ModuleTag_foo
		ModelCondition = Required:SPECIAL_WEAPON_TWO	Excluded:DYING Sound:DrogothIncinerateMS
		ModelCondition = Required:SPECIAL_WEAPON_THREE	Excluded:DYING Sound:DrogothWingBlastLoop
	End

	ClientBehavior = AnimationSoundClientBehavior ModuleTag_AnimAudioBehavior
		MaxUpdateRangeCap = 800
		AnimationSound = Sound: FellBeastWingFlaps			Animation:WUDrogoth_SKL.WUDrogoth_FLYA 	Frames: 1
		AnimationSound = Sound: FellBeastWingFlaps			Animation:WUDrogoth_SKL.WUDrogoth_FLYB 	Frames: 1
		AnimationSound = Sound: FellBeastWingFlaps			Animation:WUDrogoth_SKL.WUDrogoth_FLYC 	Frames: 1 43 91
		AnimationSound = Sound: FellBeastWingFlapsShort		Animation:WUDrogoth_SKL.WUDrogoth_HITA 	Frames: 11
		AnimationSound = Sound: FellBeastWingFlaps			Animation:WUDrogoth_SKL.WUDrogoth_LVLA 	Frames: 1 42
		AnimationSound = Sound: DrogothVoxVeterancy			Animation:WUDrogoth_SKL.WUDrogoth_LVLA 	Frames: 15
		AnimationSound = Sound: FellBeastWingFlapsShort		Animation:WUDrogoth_SKL.WUDrogoth_SPC1 	Frames: 1 22		;WingBlast start
		AnimationSound = Sound: DrogothWingBlastWingFlaps	Animation:WUDrogoth_SKL.WUDrogoth_SPC1 	Frames: 56			;WingBlast start
		AnimationSound = Sound: DrogothWingBlastWingFlaps	Animation:WUDrogoth_SKL.WUDrogoth_SPC2 	Frames: 0			;WingBlast end
		AnimationSound = Sound: FellBeastWingFlapsShort		Animation:WUDrogoth_SKL.WUDrogoth_SPC3 	Frames: 1			;WingBlast
		AnimationSound = Sound: FellBeastWingFlaps			Animation:WUDrogoth_SKL.WUDrogoth_SPCA 	Frames: 1 41		;Fireball
		AnimationSound = Sound: FellBeastWingFlaps			Animation:WUDrogoth_SKL.WUDrogoth_SPCB 	Frames: 1 37 71 106 ;Incinerate
		AnimationSound = Sound: FellBeastWingFlaps			Animation:WUDrogoth_SKL.WUDrogoth_SPCF 	Frames: 1			;Fireflight
		AnimationSound = Sound: DrogothWingBlastWingFlaps	Animation:WUDrogoth_SKL.WUDrogoth_SPCF 	Frames: 28			;Fireflight
	End


	; *** ENGINEERING Parameters ***

	RadarPriority = UNIT
	KindOf = HERO PRELOAD SELECTABLE CAN_CAST_REFLECTIONS SCORE NO_FREEWILL_ENTER SCARY MONSTER CANNOT_RETALIATE ARMY_SUMMARY GIANT_BIRD
 
	Body = RespawnBody ModuleTag_02
		CheerRadius 	  = EMOTION_CHEER_RADIUS
		MaxHealth         = GORHAUD_HEALTH
		HealingBuffFx     = None
	End

	Behavior = AutoHealBehavior ModuleTag_FellbeastHealing
		StartsActive			= Yes
		HealingAmount			= GORHAUD_HEAL_AMOUNT
		HealingDelay			= 1000
		StartHealingDelay		= 15000
		HealOnlyIfNotInCombat	= Yes
	End

	Behavior = RespawnUpdate ModuleTag_RespawnUpdate
		DeathAnim					= DYING
		;DeathFX						= FX_DrogothDieToRespawn		;FXList to play when killed-to-respawn
		;InitialSpawnFX				= FX_DrogothInitialSpawn		;FX_NazgulInitialSpawn
		;RespawnFX					= FX_DrogothRespawn				;FX_NazgulRespawn		;FXList to play when respawning.
		AutoRespawnAtObjectFilter	= NONE +CASTLE_KEEP				;Respawn at this location -- and at it's exit production point if possible.
		ButtonImage					= HIDrogoth_res
		
		;RespawnEntries determine the ruleset for how a character can be revived. Some units may automatically respawn, others
		;may require a specific revive action performed on him. You can specify different values for each level... or use Level:Any
		RespawnRules =	AutoSpawn:No	Cost:4750	Time:120000	Health:100%		;DEFAULT VALUES
	End
 
	Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = Hero
    End

	 Behavior = GiantBirdAIUpdate ModuleTag_GiantBirdAI
	    AutoAcquireEnemiesWhenIdle	= Yes ATTACK_BUILDINGS
	    MoodAttackCheckRate			= 500
	    AILuaEventsList				= FellBeastFunctions	
		FollowThroughDistance		= 200
		FollowThroughCheckStep		= 50
		FollowThroughGradient		= 1.0
		
		GrabTossTimeTrigger			= 2.5
		GrabTossHeightTrigger		= 100.0
		TossFX						= FX_DiebyFalling
		SpecialContactPoints		= Swoop

		AttackPriority = AttackPriority_FellBeast
	  End
	
	LocomotorSet
		Locomotor = FellBeastLocomotor
		Condition = SET_NORMAL 
		Speed     = 100  ;88
	End
	LocomotorSet
		Locomotor = FellBeastLocomotor
		Condition = SET_SUPERSONIC 
		Speed     = 150 ;114
	End
	LocomotorSet
		Locomotor = FellBeastLocomotor
		Condition = SET_WANDER 
		Speed     = 90
	End
	LocomotorSet
		Locomotor = FellBeastSwoopLocomotor
		Condition = SET_PANIC
		Speed     = 120
	End
	
	Behavior = PhysicsBehavior ModuleTag_04
	End

	;---------GO ON FOOT------------------------------------------------------------------------
 	Behavior = SpecialPowerModule ModuleTag_EagleToggleStarter                      
 		SpecialPowerTemplate		= SpecialAbilityShapeshiftOne
 		UpdateModuleStartsAttack	= Yes
 		StartsPaused				= No
		;InitiateSound				= FellBeastVoiceMove
 	End

	Behavior = ToggleMountedSpecialAbilityUpdate ModuleTag_Dismount
 		SpecialPowerTemplate    = SpecialAbilityShapeshiftOne
 		StartAbilityRange		= 50.0									; pretty small so we are forced to the right place.
 		MountedTemplate			= AngmarGorhaudOnFoot 
 		SynchronizeTimerOnSpecialPower = SpecialAbilityDrogothFireball SpecialAbilityMorgulDevastation SpecialAbilityWordOfPower SpecialAbilityDrogothIncinerate
		UnpackTime              = 0
 		PreparationTime         = 1  
; 		PersistentPrepTime      = 250
 		PackTime                = 0
 		OpacityTarget			= 1										; How see-thru to be at peak of change
 		AwardXPForTriggering    = 0
            UnpackingVariation		= 1
 		IgnoreFacingCheck		= Yes
	End

	;--------------- FROST BALL---------------------------------------------------------------
	Behavior = SpecialPowerModule ModuleTag_FireballStarter                      
		SpecialPowerTemplate		= SpecialAbilityDrogothFireball
		UpdateModuleStartsAttack	= Yes
		StartsPaused			= No								; get this at level 1.
		InitiateSound			= DrogothVoxAttack
	End

	Behavior = WeaponFireSpecialAbilityUpdate ModuleTag_FireballUpdate   
		SpecialPowerTemplate    = SpecialAbilityDrogothFireball
		WhichSpecialWeapon		= 1										; sets SPECIAL_WEAPON_ONE
		UnpackTime             	= 1800									; leaning back
		PreparationTime			= 10									; just a small amount
		PackTime				= 950									; returning to flap
		AwardXPForTriggering    = 0
		StartAbilityRange		= GORHAUD_FROSTBALL_RANGE
		MustFinishAbility		= Yes
		SpecialWeapon			= GorhaudFrostball
	End

	;--------- FREEZING HEARTH -----------------------------------------------------------------
	Behavior = FireWeaponUpdate ModuleTag_WeaponFiringFreezingHearth
		FireWeaponNugget
			WeaponName = GorhaudFreezingHearthRadiusWeapon
			Offset = X:0 Y:0 Z:0
			FireDelay = 0
			OneShot = No
		End
	End
	Behavior = UnpauseSpecialPowerUpgrade ModuleTag_FreezingHearth
		SpecialPowerTemplate		= SpecialAbilityFakeLeadership2
		TriggeredBy					= Upgrade_ObjectLevel3
	End
	Behavior = SpecialPowerModule ModuleTag_FreezingHearthUpdate
		SpecialPowerTemplate		= SpecialAbilityFakeLeadership2
		UpdateModuleStartsAttack	= Yes
		StartsPaused				= Yes
	End
	Behavior = AttributeModifierAuraUpdate ModuleTag_FreezingHearthBuff
		StartsActive	= No										; If no, requires upgrade to turn on.
		BonusName		= GenericHeroLeadership
		TriggeredBy		= Upgrade_ObjectLevel3
		RefreshDelay	= 2000
		Range			= 200
		AntiCategory	= BUFF
		ObjectFilter	= UNDEAD_BUFF_RECIPIENT_OBJECT_FILTER
	End
	
	;-------------------- MORGUL DEVASTATION ---------------------------------
	Behavior = UnpauseSpecialPowerUpgrade ModuleTag_MorgulDevastationUnpause
		SpecialPowerTemplate	= SpecialAbilityMorgulDevastation
		TriggeredBy				= Upgrade_ObjectLevel6 ;Upgrade_BlackRiderMorgulBlade
		ObeyRechageOnTrigger		= Yes
	End

	Behavior = SpecialPowerModule ModuleTag_MorgulDevastationStarter
		SpecialPowerTemplate		= SpecialAbilityMorgulDevastation
		UpdateModuleStartsAttack	= Yes
		StartsPaused				= Yes
		;TriggerFX				= FX_WellOfSoulsWeapon
		InitiateSound				= DrogothVoxAttack
	End

	Behavior = WeaponFireSpecialAbilityUpdate ModuleTag_MorgulDevastationUpdate
		SpecialPowerTemplate    = SpecialAbilityMorgulDevastation
		UnpackTime              = 1000
		PackTime                = 1000
		AwardXPForTriggering    = 0
		StartAbilityRange		= 150.0 ;40
		SpecialWeapon			= GorhaudMorgulDevastation
		WhichSpecialWeapon		= 3						; sets SPECIAL_WEAPON_TWO
		;UnpackSound				= DrogothIncinerateMS
		;TriggerSound			= DrogothIncinerateMS		;too much delay
	End

	Behavior = AutoAbilityBehavior ModuleTag_MorgulDevastationAutoAbility
		SpecialAbility	= SpecialAbilityMorgulDevastation
		MaxScanRange	= 150.0 ;ANGMAR_NECRO_FELL_STRENGTH_START_RANGE	
		Query			= 10 ANY ENEMIES +INFANTRY +CAVALRY				; then a group of guys
		;Query			= 1 ALL ENEMIES						; then anything
	End
	;------------------- BLIZZARD ------------------------------------------------
	Behavior = UnpauseSpecialPowerUpgrade ModuleTag_IncinerateUnpause
		SpecialPowerTemplate	= SpecialAbilityDrogothIncinerate
		TriggeredBy				= Upgrade_ObjectLevel10 ; Upgrade_ObjectLevel6
		ObeyRechageOnTrigger		= Yes
	End

	Behavior = SpecialPowerModule ModuleTag_IncinerateStarter
		SpecialPowerTemplate		= SpecialAbilityDrogothIncinerate
		UpdateModuleStartsAttack	= Yes
		StartsPaused				= Yes
		InitiateSound				= DrogothVoxAttack
	End

	Behavior = WeaponFireSpecialAbilityUpdate ModuleTag_IncinerateUpdate
		SpecialPowerTemplate    = SpecialAbilityDrogothIncinerate
		UnpackTime              = 1300
		PackTime                = 3700
		AwardXPForTriggering    = 0
		StartAbilityRange		= 40.0
		SpecialWeapon			= GorhaudBlizzard
		WhichSpecialWeapon		= 2						; sets SPECIAL_WEAPON_TWO
		;UnpackSound				= DrogothIncinerateMS
		;TriggerSound			= DrogothIncinerateMS		;too much delay
	End

	;---------DREAD VISAGE------------------------------------------------------------------------
	Behavior = UnpauseSpecialPowerUpgrade ModuleTag_DreadVisage
		SpecialPowerTemplate		= SpecialAbilityFakeLeadership
		TriggeredBy					= Upgrade_ObjectLevel1
	End
	Behavior = SpecialPowerModule ModuleTag_DreadVisageUpdate
		SpecialPowerTemplate		= SpecialAbilityFakeLeadership
		UpdateModuleStartsAttack	= Yes
		StartsPaused				= No ;Yes
	End
	Behavior = AttributeModifierAuraUpdate ModuleTag_DreadVisageAura
		StartsActive	= No														;If no, requires upgrade to turn on.
		TriggeredBy		= Upgrade_DreadVisage
		RefreshDelay	= 2000
		Range			= WITCHKING_DREADVISAGE_EFFECT_RADIUS
		TargetEnemy		= Yes
		AntiCategory	= LEADERSHIP BUFF
		BonusName		= GenericDebuff
		ObjectFilter	= ANY +INFANTRY +CAVALRY -STRUCTURE -BASE_FOUNDATION  -HERO -HORDE
	End
	Behavior = RadiateFearUpdate ModuleTag_DreadVisageFear
		InitiallyActive						= No
		TriggeredBy							= Upgrade_DreadVisage
		WhichSpecialPower					= 1
		GenerateFear						= Yes
		EmotionPulseRadius					= WITCHKING_DREADVISAGE_EFFECT_RADIUS
		EmotionPulseInterval				= 2000
	End

	;------- DARK ANNIHILATION --------------------------------------------------------------------------------
	Behavior = UnpauseSpecialPowerUpgrade ModuleTag_WordEnabler
		SpecialPowerTemplate = SpecialAbilityWordOfPower
		TriggeredBy = Upgrade_ObjectLevel10
		ObeyRechageOnTrigger		= Yes
	End
	Behavior = SpecialPowerModule ModuleTag_WordStarter       
		SpecialPowerTemplate      = SpecialAbilityWordOfPower
		UpdateModuleStartsAttack  = Yes
		TriggerFX			= FX_FellStrength
		StartsPaused		  	  = Yes
		InitiateSound 		= DragonAllyVoxRoarBig
	End
	Behavior = WeaponFireSpecialAbilityUpdate ModuleTag_WordWeaponFireUpdate   
		SpecialPowerTemplate    = SpecialAbilityWordOfPower
		WhichSpecialWeapon		= 2
		SkipContinue			= Yes

		UnpackTime              = 1700 
		PackTime                = 1000	
		FreezeAfterTriggerDuration = 2500 ; Hold AI for this long after we fire.
		
		AwardXPForTriggering    = 0		
		StartAbilityRange		= 80.0
		
		SpecialWeapon			= GorhaudDarkAnnihilation
	End		
	 
	Behavior = SpecialPowerModule ModuleTag_FellbeastLevelAttack                      
		SpecialPowerTemplate      = SpecialAbilityLevelAttack
		UpdateModuleStartsAttack  = Yes
	End

	Behavior = FellBeastSwoopPower ModuleTag_FellBeastSwoopPower ; special fellbeast swoop power
		SpecialPowerTemplate		= SpecialAbilityLevelAttack
		UnpackTime					= 1 ; hit the guy
		AwardXPForTriggering		= 0		
		StartAbilityRange			= 1000.0		
	End
  
	Behavior = SlowDeathBehavior ModuleTag_SlowDeath
		DeathTypes			= ALL  
		DestructionDelay	= 500
		ShadowWhenDead		= No
		Sound				= INITIAL DrogothVoxDie
        FX					= INITIAL FX_DrogothDeath
   	End

	Behavior = SquishCollide ModuleTag_06
	End

	Behavior = NotifyTargetsOfImminentProbableCrushingUpdate ModuleTag_NotifyCrushScan
	End

	;-- AUTO ABILITY MODULES -------------------------------------------------------------------------
	Behavior = AutoAbilityBehavior ModuleTag_FireBallAutoAbility
		SpecialAbility	= SpecialAbilityDrogothFireball
		Query			= 1 ANY ENEMIES +HERO							; try a hero first
		Query			= 10 ANY ENEMIES +INFANTRY +CAVALRY				; then a group of guys
	End		

	Behavior = AutoAbilityBehavior ModuleTag_FireflightAutoAbility
		SpecialAbility	= SpecialAbilityDrogothFireflight
		Query			= 1 ANY ENEMIES +HERO							; try a hero first
		Query			= 10 ANY ENEMIES +INFANTRY +CAVALRY				; then a group of guys
		Query			= 1 ALL ENEMIES									; then anything
	End

      Behavior = SubObjectsUpgrade ModuleTag_HideArmor
            TriggeredBy = Upgrade_ObjectLevel1
            HideSubObjects = dragonarmor
            HideSubObjects = DRAGONSTRIKEWIN
      End

      Behavior = SubObjectsUpgrade ModuleTag_ShowArmor
           TriggeredBy = Upgrade_ObjectLevel5
           ShowSubObjects = dragonarmor
      End
		

	;///////////////////
	; AISpecialPowers
	;///////////////////
	
	Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
		CommandButtonName = Command_SetStanceBattle
		SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
	End

	Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
		CommandButtonName = Command_SetStanceAggressive
		SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
	End

	Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
		CommandButtonName = Command_SetStanceHoldGround
		SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
	End

	
	Behavior = AISpecialPowerUpdate DrogothFireballAI
		CommandButtonName = Command_DrogothFireball
		SpecialPowerAIType = AI_SPECIAL_POWER_ENEMY_TYPE_KILLER_RANGED
	End

	Behavior = AISpecialPowerUpdate DrogothWingBlastAI
		CommandButtonName = Command_DrogothWingBlast
		SpecialPowerAIType = AI_SPECIAL_POWER_RANGED_AOE_ATTACK
		SpecialPowerRadius = 100
	End
	
	Behavior = AISpecialPowerUpdate DrogothIncinerateAI
		CommandButtonName = Command_DrogothIncinerate
		SpecialPowerAIType = AI_SPECIAL_POWER_RANGED_AOE_ATTACK
		SpecialPowerRadius = 100
	End
	
	Behavior = AISpecialPowerUpdate DrogothFireflightAI
		CommandButtonName = Command_DrogothFireflight
		SpecialPowerAIType = AI_SPECIAL_POWER_RANGED_AOE_ATTACK
		SpecialPowerRadius = 100
	End
	
	FormationPreviewDecal 
		Texture = FPflyingUnitDecal
		Width = 128
		Height = 128
    End	

	Geometry			= CYLINDER
	GeometryMinorRadius = 39.0
	GeometryMajorRadius = 39.0
	GeometryHeight		= 40.0
	GeometryOffset		= X:0 Y:0 Z:-10
	GeometryIsSmall		= No
	Shadow				= SHADOW_VOLUME_NON_SELF_3; volumetric shadow that doesn't cast onto all objects using SHADOW_VOLUME_NON_SELF_3
	ShadowSunAngle		= 89; clamp the angle so shadow casts straight down.
End
;--------------------------------------------------------------------------------------------------------------------------------------------

Object AngmarGorhaudOnFoot
	
	;This is required for garrisoned objects - please put in all objects.
	ButtonImage = HIDrogoth
    
      ;SelectPortrait for Heros is portrait behind skill buttons. HP = HeroPortrait.
	SelectPortrait = HPDrogoth_Portrait
	Scale = 1.4
	DescriptionStrategic = CONTROLBAR:LW_ToolTip_Brisal
	
	Draw = W3DScriptedModelDraw ModuleTag_01
		StaticModelLODMode = Yes

		DefaultModelConditionState
			Model = KUDrgnLch_SKN
			;Skeleton = SumnDrag_SKL
			ParticleSysBone = None SoWolf_Ambient_fog01 ;B_CHEST
			ParticleSysBone = None SoWolf_Ambient_Embers01 ;B_CHEST
			ParticleSysBone = BAT_WING12 SoWolf_Ambient_fog FollowBone:YES	;"BIP L HAND"
			ParticleSysBone = BAT_WING12 SoWolf_Ambient_Embers FollowBone:YES
			ParticleSysBone = BAT_WING16 SoWolf_Ambient_fog FollowBone:YES	;"BIP R HAND"
			ParticleSysBone = BAT_WING16 SoWolf_Ambient_Embers FollowBone:YES
			ParticleSysBone = BAT_WING15 SoWolf_Ambient_fog FollowBone:YES	;"BIP R HAND"
			ParticleSysBone = BAT_WING15 SoWolf_Ambient_Embers FollowBone:YES
			ParticleSysBone = BAT_WING02 SoWolf_Ambient_fog FollowBone:YES	;"BIP R HAND"
			ParticleSysBone = BAT_WING02 SoWolf_Ambient_Embers FollowBone:YES
		End	
		
		IdleAnimationState
			StateName = STATE_Idle
			Animation = Breathe
				AnimationName = SumnDrag_SKL.SumnDrag_IDLA
				AnimationMode = ONCE
				AnimationPriority = 5
			End
			;ParticleSysBone = BAT_HEAD SummonedDragonFireSnort	FollowBone:Yes
			;ParticleSysBone = BAT_HEAD SummonedDragonSnortEmbers	FollowBone:Yes
			;ParticleSysBone = B_MAINBONE SummonedDragonWaves	FollowBone:Yes
			;ParticleSysBone = B_MAINBONE SummonedDragonSmokeWaves FollowBone:Yes

			BeginScript
				Prev = CurDrawablePrevAnimationState()
				if Prev == "STATE_Selected"	then 
				CurDrawableSetTransitionAnimState("TRANS_Selected_to_Idle") return end
 				if Prev == "STATE_WingBlast" then
 					CurDrawableSetTransitionAnimState("TRANS_WingBlast_To_Idle") end
			EndScript
		End

		;;; FIREBALL ;;;
		AnimationState		= SPECIAL_WEAPON_ONE
			Animation		= SPCE
				AnimationName	= WUDrogoth_SKL.WUDrogoth_SPCE
				AnimationMode     = LOOP
			End
		End

            ;;; GO ON AIR ;;;
		AnimationState        = PACKING_TYPE_1
			Animation           = CHRA
				AnimationName     = SumnDrag_SKL.SumnDrag_JMPA
				AnimationMode     = ONCE
			End
		End

		;--- MORGUL DEVASTATION ----------------------------------------------------------------------------
		AnimationState			= SPECIAL_WEAPON_THREE
			Animation
				AnimationName				= SumnDrag_SKL.SumnDrag_RORA
				AnimationMode				= ONCE
				AnimationSpeedFactorRange	= 0.9 0.9				; to match the weapon timing.
			End
		End

		;--- DARK ANNIHILATION ----------------------------------------------------------------------------
		AnimationState			= SPECIAL_WEAPON_TWO
			Animation
				AnimationName				= SumnDrag_SKL.SumnDrag_RORA
				AnimationMode				= ONCE
				AnimationSpeedFactorRange	= 0.9 0.9				; to match the weapon timing.
			End
		End

		AnimationState						= PARALYZED
			Animation
				AnimationName				= WUDrogoth_SKL.WUDrogoth_IDLA
				AnimationMode				= LOOP
			End
		End

   	    TransitionState = TRANS_WingBlastStart
   			Animation
   				AnimationName = SumnDrag_SKL.SumnDrag_IDLA
   				AnimationMode = ONCE
   			End  
   		End
   		
   		TransitionState = TRANS_WingBlastStop
   			Animation
   				AnimationName = SumnDrag_SKL.SumnDrag_LNDA
   				AnimationMode = ONCE
   			End  
   		End

		;;; ROAR ;;;
		AnimationState			= USER_3
			Animation			= ROAR
				AnimationName		= SumnDrag_SKL.SumnDrag_RORA
				AnimationMode		= ONCE
			End
				FXEvent			= Frame:30 Name:FX_FearBlast
		End

		;;; FIRE FLIGHT ;;;
		AnimationState			= USER_1
			Animation			= SPCE
				AnimationName		= WUDrogoth_SKL.WUDrogoth_SPCE
				AnimationMode		= ONCE
			End
		End

		AnimationState			= USER_2
			StateName = State_JustBuilt
			Animation
				AnimationName = SumnDrag_SKL.SumnDrag_LNDA
				AnimationMode = ONCE
				AnimationBlendTime = 0
				AnimationSpeedFactorRange	=	0.5 0.5
			End
			ParticleSysBone = NONE SummonedDragonDust	FollowBone:Yes
		End
	
		AnimationState					=	DYING DEATH_1
			Animation					=	Dying 
				AnimationName			=	SumnDrag_SKL.SumnDrag_DIEA
				AnimationMode			=	ONCE
				AnimationBlendTime		=	15
			End
			ParticleSysBone = BAT_HEAD SummonedDragonDeathEmbers		FollowBone:Yes
			ParticleSysBone = BAT_HEAD SummonedDragonDeathSmoke			FollowBone:Yes
			ParticleSysBone = NONE SummonedDragonDeathDust		FollowBone:Yes
			
		End

		AnimationState = FIRING_OR_PREATTACK_A MOVING	; Need this, otherwise we slide between attacks.
			Animation
				AnimationName				= SumnDrag_SKL.SumnDrag_WLKA
				AnimationMode				= LOOP
				AnimationSpeedFactorRange	= 1.3 1.3
			End
			ParticleSysBone = B_MAINBONE SummonedDragonWaves	FollowBone:Yes
			ParticleSysBone = B_MAINBONE SummonedDragonSmokeWaves FollowBone:Yes
		End

		AnimationState = FIRING_OR_PREATTACK_A
			Animation			= Burninate
				AnimationName	= SumnDrag_SKL.SumnDrag_ATKA
				AnimationMode	= ONCE
			End
			ParticleSysBone = BAT_HEAD DragolichFrostBreath2	FollowBone:Yes
			;ParticleSysBone = BAT_HEAD DragolichFrostHeat	FollowBone:Yes
			ParticleSysBone = BAT_HEAD DragolichFrostEmbers		FollowBone:Yes
			;ParticleSysBone = BAT_HEAD DragolichFrostSmoke			FollowBone:Yes
			ParticleSysBone = BAT_HEAD DragolichFrostFireProxy2			FollowBone:Yes
			ParticleSysBone = B_MAINBONE SummonedDragonWaves	FollowBone:Yes
			;ParticleSysBone = B_MAINBONE DragolichFrostSmokeWaves FollowBone:Yes
		End

		AnimationState = HIT_REACTION HIT_LEVEL_1
			Animation
				AnimationName	= SumnDrag_SKL.SumnDrag_HITA
				AnimationMode	= ONCE
			End
		End

		AnimationState = MOVING TURN_RIGHT_HIGH_SPEED
			Animation
				AnimationName	= SumnDrag_SKL.SumnDrag_WLKA
				AnimationMode	= LOOP
				AnimationSpeedFactorRange = 1.8 1.8
				AnimationBlendTime		=	15
			End
		End
		
		AnimationState = MOVING TURN_LEFT_HIGH_SPEED
			Animation
				AnimationName	= SumnDrag_SKL.SumnDrag_WLKA
				AnimationMode	= LOOP
				AnimationSpeedFactorRange = 1.8 1.8
				AnimationBlendTime		=	15
			End
		End
		
		AnimationState = TURN_LEFT
			Animation			= Left
				AnimationName	= SumnDrag_SKL.SumnDrag_TRNL
				AnimationMode	= LOOP
				AnimationSpeedFactorRange = 0.85 0.85
				AnimationBlendTime		=	15
			End
		End

		AnimationState = TURN_RIGHT
			Animation			= YourOtherLeft
				AnimationName	= SumnDrag_SKL.SumnDrag_TRNR
				AnimationMode	= LOOP
				AnimationSpeedFactorRange = 0.85 0.85
				AnimationBlendTime		=	15
			End
		End

		AnimationState = MOVING ACCELERATE
			Animation
				AnimationName	= SumnDrag_SKL.SumnDrag_ACCL
				AnimationMode	= ONCE
				AnimationSpeedFactorRange = 2.0 2.0
				AnimationBlendTime		=	15
			End
		End

		AnimationState = MOVING DECELERATE
			Animation
				AnimationName	= SumnDrag_SKL.SumnDrag_DECL
				AnimationMode	= ONCE
				AnimationSpeedFactorRange = 0.9 0.9
			End

		End

		AnimationState = PACKING
			StateName				= STATE_Land
			Animation
				AnimationName		= SumnDrag_SKL.SumnDrag_LNDB
				AnimationMode		= ONCE
				AnimationBlendTime	= 0
				AnimationSpeedFactorRange = 0.5 0.5
			End
			ParticleSysBone = NONE SummonedDragonDust	FollowBone:Yes
		End

		AnimationState = MOVING
			Animation
				AnimationName	= SumnDrag_SKL.SumnDrag_WLKA
				AnimationMode	= LOOP
				AnimationSpeedFactorRange = 1.4 1.4
			End
		End

		AnimationState = SELECTED
			Animation
				AnimationName	= SumnDrag_SKL.SumnDrag_IDLA
				AnimationMode	= LOOP
				AnimationSpeedFactorRange = 1.3 1.3
			End
			
			BeginScript
				Prev = CurDrawablePrevAnimationState()
				if Prev == "STATE_Idle"	then 
					CurDrawableSetTransitionAnimState("TRANS_Idle_to_Selected") 
				if Prev == "STATE_WingBlast"	then 
					CurDrawableSetTransitionAnimState("TRANS_WingBlast_To_Idle")
					return 
				end
			EndScript
		End

		TransitionState = TRANS_WingBlast_To_Idle
			Animation			
				AnimationName	= SumnDrag_SKL.SumnDrag_LNDB
				AnimationMode	= ONCE
			End	
		End

		TransitionState = TRANS_Idle_to_Selected
			Animation			= Salute
				AnimationName	= SumnDrag_SKL.SumnDrag_RORA
				AnimationMode	= ONCE
			End
			ParticleSysBone = BAT_HEAD SummonedDragonFireRoar	FollowBone:Yes
			ParticleSysBone = BAT_HEAD SummonedDragonSmokeRoar	FollowBone:Yes
			ParticleSysBone = B_MAINBONE SummonedDragonWaves	FollowBone:Yes
			;ParticleSysBone = B_MAINBONE SummonedDragonSmokeWaves FollowBone:Yes		
		End
		
		TransitionState = TRANS_Selected_to_Idle
			Animation			= ATNC
				AnimationName	= SumnDrag_SKL.SumnDrag_IDLA
				AnimationMode	= ONCE
			End		
		End		

	    TransitionState = TRANS_JustBuilt_To_Idle
			Animation = BeingSummoned
				AnimationName = SumnDrag_SKL.SumnDrag_LNDA 
				AnimationMode = ONCE
			End
		End
		
	End

	Draw = W3DLightDraw ModuleTag_DrawLight
		Ambient = R:25 G:25 B:45
		Diffuse = R:61 G:101 B:200 ;245
		Radius = 30 ;75
		Intensity = 1 ;30 ;75
		;AttachToBoneInAnotherModule = STAFF
	End
	
	DisplayName			= OBJECT:Gorhaud
	RecruitText			= CONTROLBAR:AngmarGorhaudRecruit
	ReviveText			= CONTROLBAR:AngmarGorhaudRevive
	Hotkey				= CONTROLBAR:AngmarGorhaudHotkey
	RamPower			= 45
	RamZMult			= 0.5
	CrusherLevel           	= 4  			; What can I crush?: 1 = infantry, 2 = trees, 3 = vehicles
	CrushWeapon 		= BalrogCrush								;What can I crush?: 1 = infantry, 2 = trees, 3 = vehicles
	CrushKnockback		= 50
	CrushZFactor		= 1.0
	UseCrushAttack		= No		
	CommandSet			= GorhaudOnFootCommandSet
	CommandPoints		= 75
	Side				= Angmar
	EditorSorting		= UNIT
	ShockwaveResistance = SHOCKWAVE_RESISTANCE_ALWAYS
	ShroudClearingRange = SHROUD_CLEAR_GIANT
	VisionRange  	= 200
	TransportSlotCount	= TRANSPORTSLOTCOUNT_MONSTER
	KindOf				= SELECTABLE MONSTER CAN_ATTACK SCARY HERO SCORE
	ThreatLevel			= SUMMONEDDRAGON_THREAT_LEVEL
	RadarPriority		= UNIT
	
	WeaponSet
		Conditions = None 
		Weapon = PRIMARY	GorhaudFrostBreathAndTailSwipe
	End

	; *** AUDIO Parameters ***;

	VoiceAttack							= DrogothVoxAttack
	VoiceAttackCharge					= DrogothVoxAttackCharge
	VoiceCreated						= EVA:DrogothCreated
	VoiceFullyCreated					= EVA:DrogothCreated
	VoiceFear							= EVA:DrogothHelpMe
	VoiceGuard							= DrogothVoxMoveMS
	VoiceMove							= DrogothVoxMoveMS
	VoicePriority						= 90
	VoiceSelect							= DrogothVoxSelect

	VoiceEnterStateAttack				= DrogothVoxEnterStateAttack
	VoiceEnterStateAttackCharge			= DrogothVoxEnterStateAttackCharge
	VoiceEnterStateAttackStructure		= DrogothVoxEnterStateAttackBuilding

	SoundAmbient						= DrogothVoxAmbientLoop
	SoundImpact							= ImpactHorse
  

    #include "..\..\..\includes\StandardUnitEvaEvents.inc"
	
	ClientBehavior = ModelConditionAudioLoopClientBehavior ModuleTag_foo
		ModelCondition = Required:FIRING_OR_PREATTACK_A		Excluded:DYING	Sound:DragonAllyFirebreathMS
	End

	ClientBehavior = AnimationSoundClientBehavior ModuleTag_AnimAudioBehavior
		MaxUpdateRangeCap = 800
;		AnimationSound = Sound: DrogothVoxMoveMS		Animation:SumnDrag_SKL.SumnDrag_WLKA 	Frames: 19 40
		AnimationSound = Sound: BalrogLand				Animation:SumnDrag_SKL.SumnDrag_LNDA 	Frames: 27
		AnimationSound = Sound: FellBeastWingFlaps		Animation:SumnDrag_SKL.SumnDrag_LNDA 	Frames: 27
		AnimationSound = Sound: FellBeastWingFlaps		Animation:SumnDrag_SKL.SumnDrag_JMPB 	Frames: 24 51 83
		AnimationSound = Sound: DrogothVoxMoveMS		Animation:SumnDrag_SKL.SumnDrag_JMPB 	Frames: 10
		AnimationSound = Sound: DragonAllyVoxRoar		Animation:SumnDrag_SKL.SumnDrag_JMPB 	Frames: 28
		AnimationSound = Sound: DragonAllyVoxHurt		Animation:SumnDrag_SKL.SumnDrag_HITA 	Frames: 14
		AnimationSound = Sound: DrogothVoxMoveMS		Animation:SumnDrag_SKL.SumnDrag_TRNL 	Frames: 11 22 33 44
		AnimationSound = Sound: DrogothVoxMoveMS		Animation:SumnDrag_SKL.SumnDrag_TRNR 	Frames: 11 22 33 44
		AnimationSound = Sound: DrogothVoxMoveMS		Animation:SumnDrag_SKL.SumnDrag_ACCL 	Frames: 18 23
		AnimationSound = Sound: DrogothVoxMoveMS		Animation:SumnDrag_SKL.SumnDrag_DECL 	Frames: 17 25
		AnimationSound = Sound: DrogothVoxMoveMS		Animation:SumnDrag_SKL.SumnDrag_JMPB 	Frames: 11 21
		AnimationSound = Sound: FellBeastWingFlaps		Animation:SumnDrag_SKL.SumnDrag_JMPB 	Frames: 19 55 85
		AnimationSound = Sound: DragonAllyVoxRoar		Animation:SumnDrag_SKL.SumnDrag_JMPB 	Frames: 31
		AnimationSound = Sound: FellBeastWingFlaps		Animation:SumnDrag_SKL.SumnDrag_LNDB 	Frames: 1
		AnimationSound = Sound: BalrogLand				Animation:SumnDrag_SKL.SumnDrag_LNDB 	Frames: 26
		AnimationSound = Sound: DragonAllyVoxRoarBig	Animation:SumnDrag_SKL.SumnDrag_RORA 	Frames: 14
	End

    ; Warn the player when the enemy gets a unit. Override the normal sighting event from StandardUnitEvaEvents.inc
	EvaEnemyObjectSightedEvent = DiscoveredEnemyDragon

	ClientUpdate = EvaAnnounceClientCreate ModuleTag_CreateAnnounce
		AnnouncementEventEnemy = DiscoveredEnemyDragon
		AnnouncementEventAlly = None
		AnnouncementEventOwner = None
		
		OnlyIfVisible = Yes						; Don't announce if hidden in the shroud
		CountAsFirstSightedAnnoucement = Yes	; Don't re-annouce if going into shroud & back
		UseObjectsPosition = No					; Play from central Fortress, not at unit's position
		CreateFakeRadarEvent = Yes				; Allow player to jump to unit after hearing annoucement
	End

	;-------------------------------------

  	Behavior = HitReactionBehavior HitReactionBehaviorModuleTag
		HitReactionLifeTimer1 = 2000
		HitReactionThreshold1 = 200
	End
	
	ArmorSet
		Conditions      = None
		Armor           = DragolichArmor
		DamageFX        = FellBeastDamageFX
	End

	;-------------------------------------

  	Behavior = SlowDeathBehavior ModuleTag_NormalDeath
		DeathTypes			= ALL -FADED
		DestructionDelay	= 20000
		DecayBeginTime		= 3000
		SinkDelay			= 5000
		SinkRate			= 2.0
		DeathFlags			= DEATH_1
		Sound				= INITIAL DragonAllyVoxDie
		OCL					= INITIAL OCL_SummonedDragonDeathCrush
	End

  	Behavior = SlowDeathBehavior ModuleTag_FadeDeath
		DeathTypes			= NONE +FADED
        DeathFlags			= DEATH_2
		FadeDelay			= 0
		FadeTime			= 5000
		DestructionDelay	= 5000
		Sound				= INITIAL DragonAllyUnsummon
	End
  
	Behavior = AIUpdateInterface ModuleTag_AI
		AutoAcquireEnemiesWhenIdle = Yes ATTACK_BUILDINGS
	End

	Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
		GravityMult = 1.0
	End
	
	Behavior = SpecialPowerModule ModuleTag_TeleportStarter                      
		SpecialPowerTemplate		= SpecialAbilitySummonedDragonReposition
		UpdateModuleStartsAttack	= Yes
		InitiateSound				= DragonAllyVoxTeleport
	End

	Behavior = TeleportSpecialAbilityUpdate ModuleTag_TeleportUpdate   
		SpecialPowerTemplate    = SpecialAbilitySummonedDragonReposition
		UnpackTime              = 3800
		PreparationTime			= 1
		PackTime                = 1600
		ApproachRequiresLOS		= No
		BusyForDuration			= 5000										; don't accept any AI for this long... ai commands will be queued (should be at least PackTime)
		DestinationWeaponName	= SummonDragonBlowBack						; Fires at point of teleport to push people away and down.
	End

	Behavior = GrantUpgradeCreate ModuleTag_BuildHackUpgrade
           UpgradeToGrant				= Upgrade_TestBuilding
           GiveOnBuildComplete			= Yes ; The ExemptStatus UnderConstruction hack doesn't work on foundation buildings.
     End

	Behavior = ModelConditionUpgrade ModuleTag_BuildHackUserFlag
           TriggeredBy					= Upgrade_TestBuilding
           RequiresAllTriggers			= Yes
           ;AddConditionFlags			= UPGRADE_IVORY_TOWER
           AddTempConditionFlag			= ModelConditionState:USER_2 //For buildup
           TempConditionTime			= 4.0                               //try to match buildup anim time
           ;Permanent					= Yes
     End

	LocomotorSet
		Locomotor     = SummonedDragonLocomotor
		Condition     = SET_NORMAL
		Speed         = 60
	End

	; *** ENGINEERING Parameters ***

	RadarPriority = UNIT
	KindOf = HERO PRELOAD SELECTABLE CAN_CAST_REFLECTIONS SCORE NO_FREEWILL_ENTER SCARY MONSTER CANNOT_RETALIATE ARMY_SUMMARY GIANT_BIRD
 
	Body = RespawnBody ModuleTag_02
		CheerRadius 	  = EMOTION_CHEER_RADIUS
		MaxHealth         = GORHAUD_HEALTH
		HealingBuffFx     = None
	End

	Behavior = AutoHealBehavior ModuleTag_FellbeastHealing
		StartsActive			= Yes
		HealingAmount			= GORHAUD_HEAL_AMOUNT
		HealingDelay			= 1000
		StartHealingDelay		= 15000
		HealOnlyIfNotInCombat	= Yes
	End

	Behavior = RespawnUpdate ModuleTag_RespawnUpdate
		DeathAnim					= DYING
		;DeathFX						= FX_DrogothDieToRespawn		;FXList to play when killed-to-respawn
		;InitialSpawnFX				= FX_DrogothInitialSpawn		;FX_NazgulInitialSpawn
		;RespawnFX					= FX_DrogothRespawn				;FX_NazgulRespawn		;FXList to play when respawning.
		AutoRespawnAtObjectFilter	= NONE +CASTLE_KEEP				;Respawn at this location -- and at it's exit production point if possible.
		ButtonImage					= HIDrogoth_res
		RespawnAsTemplate			= AngmarGorhaud
		
		;RespawnEntries determine the ruleset for how a character can be revived. Some units may automatically respawn, others
		;may require a specific revive action performed on him. You can specify different values for each level... or use Level:Any
		RespawnRules =	AutoSpawn:No	Cost:4750	Time:120000	Health:100%		;DEFAULT VALUES
	End
 
	Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = Hero
    	End

	;---------GO ON AIR------------------------------------------------------------------------
 	Behavior = SpecialPowerModule ModuleTag_EagleToggleStarter                      
 		SpecialPowerTemplate		= SpecialAbilityShapeshiftOne
 		UpdateModuleStartsAttack	= Yes
 		StartsPaused				= No
		;InitiateSound				= FellBeastVoiceMove
 	End

	Behavior = ToggleMountedSpecialAbilityUpdate ModuleTag_EagleToggle
 		SpecialPowerTemplate    = SpecialAbilityShapeshiftOne
 		MountedTemplate			= AngmarGorhaud 
 		SynchronizeTimerOnSpecialPower = SpecialAbilityDrogothFireball SpecialAbilityMorgulDevastation SpecialAbilityWordOfPower SpecialAbilityDrogothIncinerate
 		UnpackTime              = 1000
 		PreparationTime         = 0			; none, cause we hop onto our mount in no time at all :)
 		PackTime                = 0 			; none, cause we hop onto our mount in no time at all :)
 		OpacityTarget		= .0		; How see-thru to be at peak of change
 		AwardXPForTriggering    = 0
 		IgnoreFacingCheck		= Yes
		;TriggerSound			= FellBeastVoiceMove
            UnpackingVariation		= 1
	End

	;----------- FROST BALL----------------------------------------------------------------
	Behavior = SpecialPowerModule ModuleTag_FireballStarter                      
		SpecialPowerTemplate		= SpecialAbilityDrogothFireball
		UpdateModuleStartsAttack	= Yes
		StartsPaused			= No								; get this at level 1.
		InitiateSound			= DrogothVoxAttack
	End

	Behavior = WeaponFireSpecialAbilityUpdate ModuleTag_FireballUpdate   
		SpecialPowerTemplate    = SpecialAbilityDrogothFireball
		WhichSpecialWeapon		= 1										; sets SPECIAL_WEAPON_ONE
		UnpackTime             	= 1800									; leaning back
		PreparationTime			= 10									; just a small amount
		PackTime				= 950									; returning to flap
		AwardXPForTriggering    = 0
		StartAbilityRange		= GORHAUD_FROSTBALL_RANGE
		MustFinishAbility		= Yes
		SpecialWeapon			= GorhaudFrostball
	End

	Behavior = AutoAbilityBehavior ModuleTag_FireBallAutoAbility
		SpecialAbility	= SpecialAbilityDrogothFireball
		Query			= 1 ANY ENEMIES +HERO							; try a hero first
		Query			= 10 ANY ENEMIES +INFANTRY +CAVALRY				; then a group of guys
		Query			= 4 ANY ENEMIES +MACHINE				; then a group of guys
		;Query			= 1 ALL ENEMIES	
	End

	;--------- FREEZING HEARTH -----------------------------------------------------------------
	Behavior = FireWeaponUpdate ModuleTag_WeaponFiringFreezingHearth
		FireWeaponNugget
			WeaponName = GorhaudFreezingHearthRadiusWeapon
			Offset = X:0 Y:0 Z:0
			FireDelay = 0
			OneShot = No
		End
	End
	Behavior = UnpauseSpecialPowerUpgrade ModuleTag_FreezingHearth
		SpecialPowerTemplate		= SpecialAbilityFakeLeadership2
		TriggeredBy					= Upgrade_ObjectLevel3
	End
	Behavior = SpecialPowerModule ModuleTag_FreezingHearthUpdate
		SpecialPowerTemplate		= SpecialAbilityFakeLeadership2
		UpdateModuleStartsAttack	= Yes
		StartsPaused				= Yes
	End
	Behavior = AttributeModifierAuraUpdate ModuleTag_FreezingHearthBuff
		StartsActive	= No										; If no, requires upgrade to turn on.
		BonusName		= GenericHeroLeadership
		TriggeredBy		= Upgrade_ObjectLevel5
		RefreshDelay	= 2000
		Range			= 200
		AntiCategory	= BUFF
		ObjectFilter	= UNDEAD_BUFF_RECIPIENT_OBJECT_FILTER
	End

	;---------DREAD VISAGE------------------------------------------------------------------------
	Behavior = UnpauseSpecialPowerUpgrade ModuleTag_DreadVisage
		SpecialPowerTemplate		= SpecialAbilityFakeLeadership
		TriggeredBy					= Upgrade_DreadVisage
	End
	Behavior = SpecialPowerModule ModuleTag_DreadVisageUpdate
		SpecialPowerTemplate		= SpecialAbilityFakeLeadership
		UpdateModuleStartsAttack	= Yes
		StartsPaused				= No ;Yes
	End
	Behavior = AttributeModifierAuraUpdate ModuleTag_DreadVisageAura
		StartsActive	= No														;If no, requires upgrade to turn on.
		TriggeredBy		= Upgrade_DreadVisage
		RefreshDelay	= 2000
		Range			= WITCHKING_DREADVISAGE_EFFECT_RADIUS
		TargetEnemy		= Yes
		AntiCategory	= LEADERSHIP BUFF
		BonusName		= GenericDebuff
		ObjectFilter	= ANY +INFANTRY +CAVALRY -STRUCTURE -BASE_FOUNDATION  -HERO -HORDE
	End
	Behavior = RadiateFearUpdate ModuleTag_DreadVisageFear
		InitiallyActive						= No
		TriggeredBy							= Upgrade_DreadVisage
		WhichSpecialPower					= 1
		GenerateFear						= Yes
		EmotionPulseRadius					= WITCHKING_DREADVISAGE_EFFECT_RADIUS
		EmotionPulseInterval				= 2000
	End	


	;-------------------- MORGUL DEVASTATION ---------------------------------
	Behavior = UnpauseSpecialPowerUpgrade ModuleTag_MorgulDevastationUnpause
		SpecialPowerTemplate	= SpecialAbilityMorgulDevastation
		TriggeredBy				= Upgrade_ObjectLevel6 ;Upgrade_BlackRiderMorgulBlade
		ObeyRechageOnTrigger		= Yes
	End

	Behavior = SpecialPowerModule ModuleTag_MorgulDevastationStarter
		SpecialPowerTemplate		= SpecialAbilityMorgulDevastation
		UpdateModuleStartsAttack	= Yes
		StartsPaused				= Yes
		;TriggerFX				= FX_WellOfSoulsWeapon
		InitiateSound				= DrogothVoxAttack
	End

	Behavior = WeaponFireSpecialAbilityUpdate ModuleTag_MorgulDevastationUpdate
		SpecialPowerTemplate    = SpecialAbilityMorgulDevastation
		UnpackTime              = 1700 
		PackTime                = 1000
		AwardXPForTriggering    = 0
		StartAbilityRange		= 100.0 ;40
		SpecialWeapon			= GorhaudMorgulDevastation
		WhichSpecialWeapon		= 3						; sets SPECIAL_WEAPON_TWO
		;UnpackSound				= DrogothIncinerateMS
		;TriggerSound			= DrogothIncinerateMS		;too much delay
	End

	Behavior = AutoAbilityBehavior ModuleTag_MorgulDevastationAutoAbility
		SpecialAbility	= SpecialAbilityMorgulDevastation
		MaxScanRange	= 150.0 ;ANGMAR_NECRO_FELL_STRENGTH_START_RANGE	
		Query			= 10 ANY ENEMIES +INFANTRY +CAVALRY				; then a group of guys
		;Query			= 1 ALL ENEMIES						; then anything
	End

	;------- DARK ANNIHILATION --------------------------------------------------------------------------------
	Behavior = UnpauseSpecialPowerUpgrade ModuleTag_WordEnabler
		SpecialPowerTemplate = SpecialAbilityWordOfPower
		TriggeredBy = Upgrade_ObjectLevel10
		ObeyRechageOnTrigger		= Yes
	End
	Behavior = SpecialPowerModule ModuleTag_WordStarter       
		SpecialPowerTemplate      = SpecialAbilityWordOfPower
		UpdateModuleStartsAttack  = Yes
		TriggerFX			= FX_FellStrength
		StartsPaused		  	  = Yes
	End
	Behavior = WeaponFireSpecialAbilityUpdate ModuleTag_WordWeaponFireUpdate   
		SpecialPowerTemplate    = SpecialAbilityWordOfPower
		WhichSpecialWeapon		= 2
		SkipContinue			= Yes

		UnpackTime              = 1700 
		PackTime                = 1000	
		FreezeAfterTriggerDuration = 2500 ; Hold AI for this long after we fire.
		
		AwardXPForTriggering    = 0		
		StartAbilityRange		= 80.0
		
		SpecialWeapon			= GorhaudDarkAnnihilation
	End

	;-----BLIZZARD---------------------------------------------------------------
	Behavior = UnpauseSpecialPowerUpgrade ModuleTag_IncinerateUnpause
		SpecialPowerTemplate	= SpecialAbilityDrogothIncinerate
		TriggeredBy				= Upgrade_ObjectLevel10 ; Upgrade_ObjectLevel6
		ObeyRechageOnTrigger		= Yes
	End

	Behavior = SpecialPowerModule ModuleTag_IncinerateStarter
		SpecialPowerTemplate		= SpecialAbilityDrogothIncinerate
		UpdateModuleStartsAttack	= Yes
		StartsPaused				= Yes
		InitiateSound				= DrogothVoxAttack
	End

	Behavior = WeaponFireSpecialAbilityUpdate ModuleTag_IncinerateUpdate
		SpecialPowerTemplate    = SpecialAbilityDrogothIncinerate
		UnpackTime              = 1300
		PackTime                = 3700
		AwardXPForTriggering    = 0
		StartAbilityRange		= 40.0
		SpecialWeapon			= GorhaudBlizzard
		WhichSpecialWeapon		= 2						; sets SPECIAL_WEAPON_TWO
		;UnpackSound				= DrogothIncinerateMS
		;TriggerSound			= DrogothIncinerateMS		;too much delay
	End

      Behavior = SubObjectsUpgrade ModuleTag_HideArmor
            TriggeredBy = Upgrade_ObjectLevel1
            HideSubObjects = dragonarmor
            ;HideSubObjects = DRAGONSTRIKEWIN
      End

      Behavior = SubObjectsUpgrade ModuleTag_ShowArmor
           TriggeredBy = Upgrade_ObjectLevel5
           ShowSubObjects = dragonarmor
      End

	Geometry			= CYLINDER
	GeometryMajorRadius = 50
	GeometryHeight		= 25.0
	GeometryOffset		= X:-10 Y:0 Z:0
	GeometryIsSmall		= No	
	Shadow				= SHADOW_VOLUME
End
